<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ShortFormLabs | Lead Finder + DM Prep</title>
  <style>
    :root{
      --bg:#0b0c10; --card:#12141b; --text:#e9ecf1; --muted:#a9b0bd;
      --accent:#7c5cff; --accent2:#2ee59d; --danger:#ff5c7a; --line:#232838;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:linear-gradient(180deg,#0b0c10, #090a0e);
      color:var(--text);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:22px}
    .top{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      margin-bottom:14px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:42px;height:42px;border-radius:12px;background:radial-gradient(circle at 30% 30%, var(--accent), #1f2340);
      border:1px solid var(--line); display:grid; place-items:center; font-weight:800;
    }
    .title h1{font-size:18px;margin:0}
    .title p{margin:3px 0 0; color:var(--muted); font-size:13px}
    .card{
      background:rgba(18,20,27,.92); border:1px solid var(--line);
      border-radius:18px; padding:16px; box-shadow:0 12px 28px rgba(0,0,0,.35);
    }
    .grid{display:grid;grid-template-columns:1.2fr .8fr; gap:14px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
    input,select,textarea{
      width:100%; padding:12px 12px; border-radius:12px;
      border:1px solid var(--line); background:#0f1118; color:var(--text);
      outline:none;
    }
    textarea{min-height:110px; resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:520px){.row{grid-template-columns:1fr}}
    .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    button{
      padding:11px 14px; border-radius:12px; border:1px solid var(--line);
      background:#121425; color:var(--text); cursor:pointer; font-weight:650;
    }
    button.primary{background:linear-gradient(90deg,var(--accent),#4da3ff); border:none}
    button.good{background:linear-gradient(90deg,var(--accent2),#3ad5ff); border:none; color:#071019}
    button.danger{background:linear-gradient(90deg,var(--danger),#ff8a5c); border:none}
    button:disabled{opacity:.55; cursor:not-allowed}
    .meta{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; color:var(--muted); font-size:12px}
    .pill{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#0f1118}
    .results{margin-top:14px}
    .lead{
      padding:14px; border:1px solid var(--line); border-radius:16px; background:#0f1118;
      display:grid; grid-template-columns:1fr auto; gap:10px; margin-bottom:10px;
    }
    .lead h3{margin:0;font-size:15px}
    .lead .small{color:var(--muted); font-size:12px; margin-top:4px; line-height:1.35}
    .lead .actions{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end}
    .lead a{color:inherit; text-decoration:none}
    .toast{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:18px; background:#0f1118; border:1px solid var(--line);
      padding:10px 12px; border-radius:12px; color:var(--text);
      opacity:0; pointer-events:none; transition:.25s;
      box-shadow:0 14px 28px rgba(0,0,0,.4);
      font-size:13px;
    }
    .toast.show{opacity:1}
    .note{color:var(--muted); font-size:12px; margin-top:8px; line-height:1.4}
    .hr{height:1px;background:var(--line);margin:14px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo">SF</div>
        <div class="title">
          <h1>ShortFormLabs ‚Äî Lead Finder + DM Prep</h1>
          <p>Find local businesses, copy a DM, open Instagram search. (Safe mode ‚Äî no IG login)</p>
        </div>
      </div>
      <div class="meta">
        <span class="pill" id="statusPill">Ready</span>
        <span class="pill" id="countPill">0 leads</span>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h2 style="margin:0 0 8px;font-size:15px;">1) Search businesses</h2>
        <div class="row">
          <div>
            <label>Niche</label>
            <select id="niche">
              <option value="barbers">Barbershops</option>
              <option value="dentists">Dentists</option>
              <option value="gyms">Gyms</option>
              <option value="medspas">Med Spas</option>
              <option value="plumbers">Plumbers</option>
              <option value="roofers">Roofers</option>
              <option value="restaurants">Restaurants</option>
            </select>
          </div>
          <div>
            <label>City / Area (type what people say)</label>
            <input id="area" value="Atlanta, Georgia" placeholder="Atlanta, Georgia" />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Limit results (10‚Äì60)</label>
            <input id="limit" type="number" min="10" max="60" value="30" />
          </div>
          <div>
            <label>Only show leads with website</label>
            <select id="onlyWebsite">
              <option value="no">No (show all)</option>
              <option value="yes">Yes (higher quality)</option>
            </select>
          </div>
        </div>

        <div class="btns">
          <button class="primary" id="searchBtn">Find Leads</button>
          <button id="clearBtn">Clear</button>
          <button class="good" id="csvBtn" disabled>Export CSV</button>
        </div>

        <div class="note">
          This uses OpenStreetMap (free). Some businesses won‚Äôt have websites listed ‚Äî that‚Äôs normal.
          The goal is volume + quality. Use ‚ÄúOnly show leads with website‚Äù for better hits.
        </div>

        <div class="hr"></div>

        <h2 style="margin:0 0 8px;font-size:15px;">2) Your DM template</h2>
        <label>DM Script (we auto-fill business name)</label>
        <textarea id="dmTemplate">Hey {name} ‚Äî quick question.

Do you ever miss calls or inquiries when you‚Äôre busy or after hours?

We help businesses capture and book those leads automatically (auto replies + follow-up + booking).
Want me to show you how it would look for {name}?</textarea>

        <div class="note">
          Tip: Keep it short. Ask a yes/no question. Then offer a quick demo.
        </div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 10px;font-size:15px;">Leads</h2>
        <div class="note" style="margin-top:0">
          Flow for each lead:
          <br>1) Copy DM
          <br>2) Open IG Search (paste + send)
          <br>3) Mark contacted in your notes/CSV
        </div>
        <div class="results" id="results"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
/**
 * Safe Lead Finder using Overpass API (OpenStreetMap)
 * No IG login. No automation. You manually message (keeps you safe).
 */

const statusPill = document.getElementById('statusPill');
const countPill  = document.getElementById('countPill');
const resultsEl  = document.getElementById('results');
const toastEl    = document.getElementById('toast');

const nicheSelect = document.getElementById('niche');
const areaInput   = document.getElementById('area');
const limitInput  = document.getElementById('limit');
const onlyWebsite = document.getElementById('onlyWebsite');

const searchBtn = document.getElementById('searchBtn');
const clearBtn  = document.getElementById('clearBtn');
const csvBtn    = document.getElementById('csvBtn');
const dmTemplateEl = document.getElementById('dmTemplate');

let leads = [];

function toast(msg){
  toastEl.textContent = msg;
  toastEl.classList.add('show');
  setTimeout(()=>toastEl.classList.remove('show'), 1400);
}

function setStatus(text){
  statusPill.textContent = text;
}

function setCount(){
  countPill.textContent = `${leads.length} lead${leads.length===1?'':'s'}`;
  csvBtn.disabled = leads.length === 0;
}

/**
 * Map niche -> OSM tags query
 */
function getNicheQuery(niche){
  switch(niche){
    case 'barbers':     return ['shop=hairdresser', 'shop=beauty', 'amenity=barber'];
    case 'dentists':    return ['amenity=dentist'];
    case 'gyms':        return ['leisure=fitness_centre', 'leisure=sports_centre'];
    case 'medspas':     return ['healthcare=clinic', 'amenity=spa', 'shop=beauty'];
    case 'plumbers':    return ['craft=plumber', 'shop=plumbing'];
    case 'roofers':     return ['craft=roofer'];
    case 'restaurants': return ['amenity=restaurant'];
    default:            return ['shop=beauty'];
  }
}

/**
 * Overpass API helpers
 */
async function overpass(query){
  const url = 'https://overpass-api.de/api/interpreter';
  const res = await fetch(url, {
    method: 'POST',
    headers: {'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'},
    body: 'data=' + encodeURIComponent(query)
  });
  if(!res.ok) throw new Error('Overpass error');
  return await res.json();
}

/**
 * Build Overpass query by Area name
 * Note: Area name must match OSM admin boundary. "Atlanta, Georgia" usually works.
 */
function buildQuery(areaName, tagPairs, limit){
  const tagBlocks = tagPairs.map(tp => {
    const [k,v] = tp.split('=');
    return `
      node["${k}"="${v}"](area.a);
      way["${k}"="${v}"](area.a);
      relation["${k}"="${v}"](area.a);
    `;
  }).join('\n');

  return `
    [out:json][timeout:25];
    area["name"="${areaName}"]->.a;
    (
      ${tagBlocks}
    );
    out center tags ${limit};
  `;
}

function normalize(el){
  const t = el.tags || {};
  const name = t.name || '(No name listed)';
  const phone = t.phone || t['contact:phone'] || '';
  const website = t.website || t['contact:website'] || '';
  const instagram = t['contact:instagram'] || '';
  const addr = [
    t['addr:housenumber'],
    t['addr:street'],
    t['addr:city'],
    t['addr:state'],
    t['addr:postcode']
  ].filter(Boolean).join(' ');
  const lat = el.lat ?? (el.center && el.center.lat);
  const lon = el.lon ?? (el.center && el.center.lon);

  return {
    name, phone, website, instagram,
    address: addr,
    lat, lon
  };
}

function dmFor(lead){
  const raw = dmTemplateEl.value || '';
  return raw.replaceAll('{name}', lead.name);
}

function igSearchUrl(lead){
  // best we can do safely: open IG search for the business name
  const q = encodeURIComponent(lead.name);
  return `https://www.instagram.com/explore/search/keyword/?q=${q}`;
}

function mapsUrl(lead){
  if(lead.lat && lead.lon){
    return `https://www.google.com/maps?q=${lead.lat},${lead.lon}`;
  }
  return lead.address ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(lead.address)}` : '#';
}

function render(){
  resultsEl.innerHTML = '';
  if(leads.length === 0){
    resultsEl.innerHTML = `<div class="note">No leads yet. Hit <b>Find Leads</b>.</div>`;
    return;
  }

  leads.forEach((lead, idx) => {
    const el = document.createElement('div');
    el.className = 'lead';

    const left = document.createElement('div');
    left.innerHTML = `
      <h3>${escapeHtml(lead.name)}</h3>
      <div class="small">
        ${lead.address ? `üìç ${escapeHtml(lead.address)}<br>` : ''}
        ${lead.phone ? `üìû ${escapeHtml(lead.phone)}<br>` : ''}
        ${lead.website ? `üåê <a target="_blank" rel="noopener" href="${escapeAttr(lead.website)}">${escapeHtml(lead.website)}</a><br>` : ''}
        ${lead.instagram ? `üì∏ ${escapeHtml(lead.instagram)}<br>` : ''}
        <a target="_blank" rel="noopener" href="${mapsUrl(lead)}">Open in Maps</a>
      </div>
    `;

    const actions = document.createElement('div');
    actions.className = 'actions';

    const copyBtn = document.createElement('button');
    copyBtn.textContent = 'Copy DM';
    copyBtn.onclick = async () => {
      const msg = dmFor(lead);
      await navigator.clipboard.writeText(msg);
      toast('DM copied ‚úÖ');
    };

    const openIgBtn = document.createElement('button');
    openIgBtn.className = 'good';
    openIgBtn.innerHTML = `<a target="_blank" rel="noopener" href="${igSearchUrl(lead)}">Open IG Search</a>`;

    const removeBtn = document.createElement('button');
    removeBtn.className = 'danger';
    removeBtn.textContent = 'Remove';
    removeBtn.onclick = () => {
      leads.splice(idx, 1);
      setCount();
      render();
    };

    actions.appendChild(copyBtn);
    actions.appendChild(openIgBtn);
    actions.appendChild(removeBtn);

    el.appendChild(left);
    el.appendChild(actions);
    resultsEl.appendChild(el);
  });
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, c => ({
    '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
  }[c]));
}
function escapeAttr(s){
  return String(s).replace(/"/g,'&quot;');
}

searchBtn.addEventListener('click', async () => {
  const area = areaInput.value.trim();
  if(!area){
    toast('Type a city/area first');
    return;
  }

  const niche = nicheSelect.value;
  const tags = getNicheQuery(niche);
  const limit = Math.max(10, Math.min(60, parseInt(limitInput.value || '30',10)));

  setStatus('Searching‚Ä¶');
  searchBtn.disabled = true;

  try{
    const query = buildQuery(area, tags, limit);
    const data = await overpass(query);

    let items = (data.elements || []).map(normalize);

    // de-dupe by name + address
    const seen = new Set();
    items = items.filter(x => {
      const key = (x.name + '|' + (x.address||'') + '|' + (x.website||'')).toLowerCase();
      if(seen.has(key)) return false;
      seen.add(key);
      return true;
    });

    if(onlyWebsite.value === 'yes'){
      items = items.filter(x => x.website && x.website.startsWith('http'));
    }

    // keep only up to limit after filtering
    leads = items.slice(0, limit);

    setCount();
    render();
    setStatus('Done');
    toast('Leads loaded ‚úÖ');
  } catch(e){
    console.error(e);
    setStatus('Error');
    toast('Could not fetch. Try a simpler area name (ex: "Atlanta").');
  } finally{
    searchBtn.disabled = false;
  }
});

clearBtn.addEventListener('click', () => {
  leads = [];
  setCount();
  render();
  setStatus('Ready');
});

csvBtn.addEventListener('click', () => {
  if(leads.length === 0) return;

  const rows = [
    ['Name','Address','Phone','Website','Instagram','IG Search Link','Maps Link']
  ];

  for(const l of leads){
    rows.push([
      l.name || '',
      l.address || '',
      l.phone || '',
      l.website || '',
      l.instagram || '',
      igSearchUrl(l),
      mapsUrl(l)
    ]);
  }

  const csv = rows.map(r => r.map(cell => `"${String(cell).replaceAll('"','""')}"`).join(',')).join('\n');
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = `leads_${nicheSelect.value}_${(areaInput.value||'area').replace(/\s+/g,'_')}.csv`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);

  toast('CSV downloaded ‚úÖ');
});

// initial
setCount();
render();
</script>
</body>
</html>

   


